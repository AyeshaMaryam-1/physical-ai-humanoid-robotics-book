"use strict";(globalThis.webpackChunkbook_temp=globalThis.webpackChunkbook_temp||[]).push([[424],{909:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>m,frontMatter:()=>t,metadata:()=>o,toc:()=>_});const o=JSON.parse('{"id":"module_3/3_3_nav2","title":"Navigation & Motion Planning (Nav2)","description":"Purpose","source":"@site/docs/03_module_3/3_3_nav2.mdx","sourceDirName":"03_module_3","slug":"/module_3/3_3_nav2","permalink":"/physical-ai-humanoid-robotics-book/docs/module_3/3_3_nav2","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/03_module_3/3_3_nav2.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Navigation & Motion Planning (Nav2)"},"sidebar":"tutorialSidebar","previous":{"title":"Isaac ROS Perception Pipeline","permalink":"/physical-ai-humanoid-robotics-book/docs/module_3/3_2_isaac_ros_perception"},"next":{"title":"Sim-to-Real Transfer","permalink":"/physical-ai-humanoid-robotics-book/docs/module_3/3_4_sim_to_real"}}');var i=a(4848),r=a(8453);const t={sidebar_position:3,title:"Navigation & Motion Planning (Nav2)"},s="Navigation & Motion Planning (Nav2)",l={},_=[{value:"Purpose",id:"purpose",level:2},{value:"Learning Outcomes",id:"learning-outcomes",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Inputs",id:"inputs",level:2},{value:"Outputs",id:"outputs",level:2},{value:"Key Concepts",id:"key-concepts",level:2},{value:"Chapter Outline",id:"chapter-outline",level:2},{value:"1. Nav2 Architecture and Components",id:"1-nav2-architecture-and-components",level:3},{value:"2. SLAM and Mapping",id:"2-slam-and-mapping",level:3},{value:"3. Navigation Configuration",id:"3-navigation-configuration",level:3},{value:"4. Autonomous Navigation",id:"4-autonomous-navigation",level:3},{value:"Hands-On Lab",id:"hands-on-lab",level:2},{value:"Setting up Nav2 for Humanoid Robot Navigation",id:"setting-up-nav2-for-humanoid-robot-navigation",level:3},{value:"Safety Notes",id:"safety-notes",level:2},{value:"Evaluation Criteria",id:"evaluation-criteria",level:2}];function c(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"navigation--motion-planning-nav2",children:"Navigation & Motion Planning (Nav2)"})}),"\n",(0,i.jsx)(e.h2,{id:"purpose",children:"Purpose"}),"\n",(0,i.jsx)(e.p,{children:"This chapter introduces the Navigation 2 (Nav2) stack for humanoid robots, focusing on autonomous navigation and motion planning in complex environments. We'll configure Nav2 for our humanoid robot, create maps of Isaac Sim environments, and implement autonomous navigation capabilities that enable the robot to navigate safely and efficiently to specified goal poses."}),"\n",(0,i.jsx)(e.h2,{id:"learning-outcomes",children:"Learning Outcomes"}),"\n",(0,i.jsx)(e.p,{children:"After completing this chapter, you will be able to:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Configure the Nav2 stack for humanoid robot navigation"}),"\n",(0,i.jsx)(e.li,{children:"Create maps of environments using simulated LiDAR data from Isaac Sim"}),"\n",(0,i.jsx)(e.li,{children:"Implement localization, path planning, and motion control algorithms"}),"\n",(0,i.jsx)(e.li,{children:"Set up navigation safety mechanisms and obstacle avoidance"}),"\n",(0,i.jsx)(e.li,{children:"Integrate Nav2 with Isaac Sim for realistic navigation testing"}),"\n",(0,i.jsx)(e.li,{children:"Evaluate navigation performance and tune parameters for optimal results"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Completed Module 1 (ROS 2 fundamentals and humanoid URDF)"}),"\n",(0,i.jsx)(e.li,{children:"Completed Module 2 (Gazebo & Unity digital twin)"}),"\n",(0,i.jsx)(e.li,{children:"Completed Module 3.1-3.2 (Isaac Sim and perception pipeline)"}),"\n",(0,i.jsx)(e.li,{children:"Understanding of coordinate frames and transformations (TF)"}),"\n",(0,i.jsx)(e.li,{children:"Experience with ROS 2 launch files and parameter configuration"}),"\n",(0,i.jsx)(e.li,{children:"Basic knowledge of path planning algorithms"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"inputs",children:"Inputs"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Humanoid robot model with LiDAR sensor in Isaac Sim"}),"\n",(0,i.jsx)(e.li,{children:"Working Isaac Sim environment with ROS 2 bridge"}),"\n",(0,i.jsx)(e.li,{children:"Understanding of robot kinematics and dynamics"}),"\n",(0,i.jsx)(e.li,{children:"Navigation concepts (localization, mapping, path planning)"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"outputs",children:"Outputs"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Nav2 configuration files for humanoid robot"}),"\n",(0,i.jsx)(e.li,{children:"Map of Isaac Sim environment"}),"\n",(0,i.jsx)(e.li,{children:"Autonomous navigation pipeline"}),"\n",(0,i.jsx)(e.li,{children:"Navigation safety and recovery behaviors"}),"\n",(0,i.jsx)(e.li,{children:"Performance evaluation metrics for navigation"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"key-concepts",children:"Key Concepts"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Navigation 2 (Nav2) Stack"}),": ROS 2 navigation framework for autonomous navigation"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Simultaneous Localization and Mapping (SLAM)"}),": Creating maps while localizing the robot"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Path Planning"}),": Global and local path planning algorithms (A*, Dijkstra, DWA, etc.)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Motion Control"}),": Converting planned paths to robot commands"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Safety and Recovery"}),": Navigation safety mechanisms and recovery behaviors"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Environment Mapping"}),": Creating occupancy grid maps from sensor data"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Coordinate Frames"}),": Managing TF trees for navigation components"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"chapter-outline",children:"Chapter Outline"}),"\n",(0,i.jsx)(e.p,{children:"This chapter develops a complete Nav2 navigation system:"}),"\n",(0,i.jsx)(e.h3,{id:"1-nav2-architecture-and-components",children:"1. Nav2 Architecture and Components"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Understanding the Nav2 stack architecture"}),"\n",(0,i.jsx)(e.li,{children:"Key components: Planner, Controller, BT Navigator, Recovery"}),"\n",(0,i.jsx)(e.li,{children:"Configuration and parameter tuning"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"2-slam-and-mapping",children:"2. SLAM and Mapping"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Creating maps using simulated LiDAR data"}),"\n",(0,i.jsx)(e.li,{children:"Configuring SLAM algorithms for humanoid robots"}),"\n",(0,i.jsx)(e.li,{children:"Map quality assessment and optimization"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"3-navigation-configuration",children:"3. Navigation Configuration"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Setting up Nav2 for humanoid robot kinematics"}),"\n",(0,i.jsx)(e.li,{children:"Configuring global and local planners"}),"\n",(0,i.jsx)(e.li,{children:"Tuning navigation parameters"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"4-autonomous-navigation",children:"4. Autonomous Navigation"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Implementing goal-based navigation"}),"\n",(0,i.jsx)(e.li,{children:"Safety mechanisms and obstacle avoidance"}),"\n",(0,i.jsx)(e.li,{children:"Performance evaluation and tuning"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"hands-on-lab",children:"Hands-On Lab"}),"\n",(0,i.jsx)(e.h3,{id:"setting-up-nav2-for-humanoid-robot-navigation",children:"Setting up Nav2 for Humanoid Robot Navigation"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Nav2 Package Structure:"}),"\nCreate a ROS 2 package for Nav2 configuration: ",(0,i.jsx)(e.code,{children:"robotics_ws/src/humanoid_nav2_config/package.xml"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>\n<package format="3">\n  <name>humanoid_nav2_config</name>\n  <version>0.0.0</version>\n  <description>Nav2 configuration for humanoid robot in the Physical AI & Humanoid Robotics book</description>\n  <maintainer email="humanoid-robotics-book@example.com">Humanoid Robotics Book</maintainer>\n  <license>Apache-2.0</license>\n\n  <depend>nav2_bringup</depend>\n  <depend>nav2_map_server</depend>\n  <depend>nav2_planner</depend>\n  <depend>nav2_controller</depend>\n  <depend>nav2_behavior_tree</depend>\n  <depend>nav2_bt_navigator</depend>\n  <depend>nav2_recovery</depend>\n  <depend>nav2_lifecycle_manager</depend>\n  <depend>nav2_util</depend>\n  <depend>slam_toolbox</depend>\n\n  <test_depend>ament_copyright</test_depend>\n  <test_depend>ament_flake8</test_depend>\n  <test_depend>ament_pep257</test_depend>\n  <test_depend>python3-pytest</test_depend>\n\n  <export>\n    <build_type>ament_cmake</build_type>\n  </export>\n</package>\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Setup File:"}),"\nCreate ",(0,i.jsx)(e.code,{children:"robotics_ws/src/humanoid_nav2_config/CMakeLists.txt"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cmake",children:'cmake_minimum_required(VERSION 3.8)\nproject(humanoid_nav2_config)\n\nif(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES "Clang")\n  add_compile_options(-Wall -Wextra -Wpedantic)\nendif()\n\n# Find dependencies\nfind_package(ament_cmake REQUIRED)\n\n# Install configuration files\ninstall(\n  DIRECTORY config launch maps\n  DESTINATION share/${PROJECT_NAME}\n)\n\nif(BUILD_TESTING)\n  find_package(ament_lint_auto REQUIRED)\n  ament_lint_auto_find_test_dependencies()\nendif()\n\nament_package()\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Navigation Configuration:"}),"\nCreate the main navigation configuration file: ",(0,i.jsx)(e.code,{children:"robotics_ws/src/humanoid_nav2_config/config/nav2_params.yaml"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:'amcl:\n  ros__parameters:\n    use_sim_time: True\n    alpha1: 0.2\n    alpha2: 0.2\n    alpha3: 0.2\n    alpha4: 0.2\n    alpha5: 0.2\n    base_frame_id: "base_link"\n    beam_skip_distance: 0.5\n    beam_skip_error_threshold: 0.9\n    beam_skip_threshold: 0.3\n    do_beamskip: false\n    global_frame_id: "map"\n    lambda_short: 0.1\n    laser_likelihood_max_dist: 2.0\n    laser_max_range: 10.0\n    laser_min_range: -1.0\n    laser_model_type: "likelihood_field"\n    max_beams: 60\n    max_particles: 2000\n    min_particles: 500\n    odom_frame_id: "odom"\n    pf_err: 0.05\n    pf_z: 0.99\n    recovery_alpha_fast: 0.0\n    recovery_alpha_slow: 0.0\n    resample_interval: 1\n    robot_model_type: "nav2_amcl::DifferentialMotionModel"\n    save_pose_rate: 0.5\n    sigma_hit: 0.2\n    tf_broadcast: true\n    transform_tolerance: 1.0\n    update_min_a: 0.2\n    update_min_d: 0.25\n    z_hit: 0.5\n    z_max: 0.05\n    z_rand: 0.5\n    z_short: 0.05\n    scan_topic: scan\n\namcl_map_client:\n  ros__parameters:\n    use_sim_time: True\n\namcl_rclcpp_node:\n  ros__parameters:\n    use_sim_time: True\n\nbt_navigator:\n  ros__parameters:\n    use_sim_time: True\n    global_frame: map\n    robot_base_frame: base_link\n    odom_topic: /odom\n    bt_loop_duration: 10\n    default_server_timeout: 20\n    enable_groot_monitoring: True\n    groot_zmq_publisher_port: 1666\n    groot_zmq_server_port: 1667\n    navigate_through_poses: False\n    navigate_to_pose_bt_xml: "navigate_to_pose_w_replanning_and_recovery.xml"\n    navigate_through_poses_bt_xml: "navigate_through_poses_w_replanning_and_recovery.xml"\n    plugin_lib_names:\n    - nav2_compute_path_to_pose_action_bt_node\n    - nav2_compute_path_through_poses_action_bt_node\n    - nav2_follow_path_action_bt_node\n    - nav2_back_up_action_bt_node\n    - nav2_spin_action_bt_node\n    - nav2_wait_action_bt_node\n    - nav2_clear_costmap_service_bt_node\n    - nav2_is_stuck_condition_bt_node\n    - nav2_goal_reached_condition_bt_node\n    - nav2_goal_updated_condition_bt_node\n    - nav2_initial_pose_received_condition_bt_node\n    - nav2_reinitialize_global_localization_service_bt_node\n    - nav2_rate_controller_bt_node\n    - nav2_distance_controller_bt_node\n    - nav2_speed_controller_bt_node\n    - nav2_truncate_path_action_bt_node\n    - nav2_truncate_path_local_action_bt_node\n    - nav2_goal_updater_node_bt_node\n    - nav2_recovery_node_bt_node\n    - nav2_pipeline_sequence_bt_node\n    - nav2_round_robin_node_bt_node\n    - nav2_transform_available_condition_bt_node\n    - nav2_time_expired_condition_bt_node\n    - nav2_path_expiring_timer_condition\n    - nav2_distance_traveled_condition_bt_node\n    - nav2_single_trigger_bt_node\n    - nav2_is_battery_low_condition_bt_node\n    - nav2_navigate_through_poses_action_bt_node\n    - nav2_navigate_to_pose_action_bt_node\n    - nav2_remove_passed_goals_action_bt_node\n    - nav2_planner_selector_bt_node\n    - nav2_controller_selector_bt_node\n    - nav2_goal_checker_selector_bt_node\n    - nav2_controller_cancel_bt_node\n    - nav2_path_longer_on_approach_bt_node\n    - nav2_wait_cancel_bt_node\n\nbt_navigator_rclcpp_node:\n  ros__parameters:\n    use_sim_time: True\n\ncontroller_server:\n  ros__parameters:\n    use_sim_time: True\n    controller_frequency: 20.0\n    min_x_velocity_threshold: 0.001\n    min_y_velocity_threshold: 0.5\n    min_theta_velocity_threshold: 0.001\n    failure_tolerance: 0.3\n    progress_checker_plugin: "progress_checker"\n    goal_checker_plugin: "goal_checker"\n    controller_plugins: ["FollowPath"]\n\n    # Progress checker parameters\n    progress_checker:\n      plugin: "nav2_controller::SimpleProgressChecker"\n      required_movement_radius: 0.5\n      movement_time_allowance: 10.0\n\n    # Goal checker parameters\n    goal_checker:\n      plugin: "nav2_controller::SimpleGoalChecker"\n      xy_goal_tolerance: 0.25\n      yaw_goal_tolerance: 0.25\n      stateful: True\n\n    # Controller parameters\n    FollowPath:\n      plugin: "nav2_rotation_shim_controller::RotationShimController"\n      # Parameters for the underlying local planner\n      progress_checker:\n        plugin: "nav2_controller::SimpleProgressChecker"\n        required_movement_radius: 0.5\n        movement_time_allowance: 10.0\n      goal_checker:\n        plugin: "nav2_controller::SimpleGoalChecker"\n        xy_goal_tolerance: 0.25\n        yaw_goal_tolerance: 0.25\n        stateful: True\n      local_planner:\n        plugin: "nav2_regulated_pure_pursuit_controller::RegulatedPurePursuitController"\n        desired_linear_vel: 0.5\n        max_linear_accel: 2.5\n        max_linear_decel: 2.5\n        desired_angular_vel: 1.0\n        max_angular_accel: 3.2\n        min_angular_vel: 0.0\n        max_robot_pose_age: 1.0\n        transform_tolerance: 0.1\n        min_approach_linear_velocity: 0.05\n        angular_dist_threshold: 0.785\n        forward_sampling_distance: 0.5\n        rotate_to_heading_angular_vel: 1.8\n        max_angular_vel: 1.5\n        min_linear_velocity: 0.0\n        max_linear_velocity: 0.5\n        use_velocity_scaled_path: false\n        min_curvature_radius: 0.1\n        lookahead_time: 1.5\n        use_interpolation: true\n\ncontroller_server_rclcpp_node:\n  ros__parameters:\n    use_sim_time: True\n\nlocal_costmap:\n  local_costmap:\n    ros__parameters:\n      update_frequency: 5.0\n      publish_frequency: 2.0\n      global_frame: odom\n      robot_base_frame: base_link\n      use_sim_time: True\n      rolling_window: true\n      width: 10\n      height: 10\n      resolution: 0.05\n      robot_radius: 0.3\n      plugins: ["voxel_layer", "inflation_layer"]\n      inflation_layer:\n        plugin: "nav2_costmap_2d::InflationLayer"\n        cost_scaling_factor: 3.0\n        inflation_radius: 0.55\n      voxel_layer:\n        plugin: "nav2_costmap_2d::VoxelLayer"\n        enabled: True\n        publish_voxel_map: True\n        origin_z: 0.0\n        z_resolution: 0.05\n        z_voxels: 16\n        max_obstacle_height: 2.0\n        mark_threshold: 0\n        observation_sources: scan\n        scan:\n          topic: /scan\n          max_obstacle_height: 2.0\n          clearing: True\n          marking: True\n          data_type: "LaserScan"\n          raytrace_max_range: 10.0\n          raytrace_min_range: 0.0\n          obstacle_max_range: 10.0\n          obstacle_min_range: 0.0\n      always_send_full_costmap: True\n  local_costmap_client:\n    ros__parameters:\n      use_sim_time: True\n  local_costmap_rclcpp_node:\n    ros__parameters:\n      use_sim_time: True\n\nglobal_costmap:\n  global_costmap:\n    ros__parameters:\n      update_frequency: 1.0\n      publish_frequency: 1.0\n      global_frame: map\n      robot_base_frame: base_link\n      use_sim_time: True\n      robot_radius: 0.3\n      resolution: 0.05\n      track_unknown_space: true\n      plugins: ["static_layer", "obstacle_layer", "inflation_layer"]\n      obstacle_layer:\n        plugin: "nav2_costmap_2d::ObstacleLayer"\n        enabled: True\n        observation_sources: scan\n        scan:\n          topic: /scan\n          max_obstacle_height: 2.0\n          clearing: True\n          marking: True\n          data_type: "LaserScan"\n          raytrace_max_range: 10.0\n          raytrace_min_range: 0.0\n          obstacle_max_range: 10.0\n          obstacle_min_range: 0.0\n      static_layer:\n        plugin: "nav2_costmap_2d::StaticLayer"\n        map_subscribe_transient_local: True\n      inflation_layer:\n        plugin: "nav2_costmap_2d::InflationLayer"\n        cost_scaling_factor: 3.0\n        inflation_radius: 0.55\n      always_send_full_costmap: True\n  global_costmap_client:\n    ros__parameters:\n      use_sim_time: True\n  global_costmap_rclcpp_node:\n    ros__parameters:\n      use_sim_time: True\n\nmap_server:\n  ros__parameters:\n    use_sim_time: True\n    yaml_filename: "turtlebot3_world.yaml"\n\nmap_saver:\n  ros__parameters:\n    use_sim_time: True\n    save_map_timeout: 5.0\n    free_thresh_default: 0.25\n    occupied_thresh_default: 0.65\n\nplanner_server:\n  ros__parameters:\n    expected_planner_frequency: 20.0\n    use_sim_time: True\n    planner_plugins: ["GridBased"]\n    GridBased:\n      plugin: "nav2_navfn_planner::NavfnPlanner"\n      tolerance: 0.5\n      use_astar: false\n      allow_unknown: true\n\nplanner_server_rclcpp_node:\n  ros__parameters:\n    use_sim_time: True\n\nrecovery_server:\n  ros__parameters:\n    use_sim_time: True\n    recovery_plugins: ["spin", "backup", "wait"]\n    spin:\n      plugin: "nav2_recoveries::Spin"\n      sim_frequency: 20\n      angle_thresh: 0.0\n      time_allowance: 20\n    backup:\n      plugin: "nav2_recoveries::BackUp"\n      sim_frequency: 20\n      backup_dist: -0.15\n      backup_speed: 0.025\n    wait:\n      plugin: "nav2_recoveries::Wait"\n      sim_frequency: 20\n      wait_duration: 5\n\nrecovery_server_rclcpp_node:\n  ros__parameters:\n    use_sim_time: True\n\nrobot_state_publisher:\n  ros__parameters:\n    use_sim_time: True\n\nwaypoint_follower:\n  ros__parameters:\n    use_sim_time: True\n    loop_rate: 20\n    stop_on_failure: false\n    waypoint_task_executor_plugin: "wait_at_waypoint"\n    wait_at_waypoint:\n      plugin: "nav2_waypoint_follower::WaitAtWaypoint"\n      enabled: True\n      wait_time: 200\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"SLAM Configuration:"}),"\nCreate a SLAM configuration file for mapping: ",(0,i.jsx)(e.code,{children:"robotics_ws/src/humanoid_nav2_config/config/slam_params.yaml"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"slam_toolbox:\n  ros__parameters:\n    # Plugin params\n    solver_plugin: solver_plugins::CeresSolver\n    ceres_linear_solver: SPARSE_NORMAL_CHOLESKY\n    ceres_preconditioner: SCHUR_JACOBI\n    ceres_trust_strategy: LEVENBERG_MARQUARDT\n    ceres_dogleg_type: TRADITIONAL_DOGLEG\n    ceres_loss_function: None\n\n    # ROS Parameters\n    odom_frame: odom\n    map_frame: map\n    base_frame: base_link\n    scan_topic: /scan\n    mode: mapping #localization\n\n    # Additional parameters\n    debug_logging: false\n    throttle_scans: 1\n    transform_publish_period: 0.02 #0.02\n    map_update_interval: 2.0\n    resolution: 0.05\n    max_laser_range: 20.0 #for scan matching\n    minimum_time_interval: 0.5\n    transform_timeout: 0.2\n    tf_buffer_duration: 30.\n    stack_size_to_use: 40000000 #// program needs a larger stack size to prevent crashing\n    enable_interactive_mode: true\n\n    # General Parameters\n    use_scan_matching: true\n    use_scan_barycenter: true\n    minimum_travel_distance: 0.5\n    minimum_travel_heading: 0.5\n    scan_buffer_size: 10\n    scan_buffer_maximum_scan_distance: 10.0\n    link_match_minimum_response_fine: 0.1\n    link_scan_maximum_distance: 1.5\n    loop_search_maximum_distance: 3.0\n    do_loop_closing: true\n    loop_match_minimum_chain_size: 10\n    loop_match_maximum_variance_coarse: 3.0\n    loop_match_minimum_response_coarse: 0.35\n    loop_match_minimum_response_fine: 0.45\n\n    # Correlation Parameters - Correlation Parameters\n    correlation_search_space_dimension: 0.5\n    correlation_search_space_resolution: 0.01\n    correlation_search_space_smear_deviation: 0.1\n\n    # Correlation Parameters - Loop Closure Parameters\n    loop_search_space_dimension: 8.0\n    loop_search_space_resolution: 0.05\n    loop_search_space_smear_deviation: 0.03\n\n    # Scan Matcher Parameters\n    distance_variance_penalty: 0.5\n    angle_variance_penalty: 1.0\n\n    fine_search_angle_offset: 0.00349\n    coarse_search_angle_offset: 0.349\n    coarse_angle_resolution: 0.0349\n    minimum_angle_penalty: 0.9\n    minimum_distance_penalty: 0.5\n    use_icp: false\n    icp_iterations: 1000\n    icp_epsilon: 0.001\n    icp_threshold: 1.0\n    icp_sigma: 0.05\n    icp_success_ratio: 0.05\n    convergence_epsilon_a: 0.001\n    convergence_epsilon_x: 0.001\n    convergence_epsilon_theta: 0.001\n    max_iterations: 1000\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Navigation Launch File:"}),"\nCreate a launch file for Nav2 navigation: ",(0,i.jsx)(e.code,{children:"robotics_ws/src/humanoid_nav2_config/launch/navigation_launch.py"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"import os\nfrom launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument, SetEnvironmentVariable\nfrom launch.substitutions import LaunchConfiguration\nfrom launch_ros.actions import Node\nfrom ament_index_python.packages import get_package_share_directory\nfrom nav2_common.launch import RewrittenYaml\n\n\ndef generate_launch_description():\n    # Get the package share directory\n    pkg_share = get_package_share_directory('humanoid_nav2_config')\n\n    # Declare launch arguments\n    use_sim_time = DeclareLaunchArgument(\n        'use_sim_time',\n        default_value='true',\n        description='Use simulation (Isaac Sim) clock if true'\n    )\n\n    params_file = DeclareLaunchArgument(\n        'params_file',\n        default_value=os.path.join(pkg_share, 'config', 'nav2_params.yaml'),\n        description='Full path to the ROS2 parameters file to use for all launched nodes'\n    )\n\n    # Create lifecycle manager node\n    lifecycle_manager = Node(\n        package='nav2_lifecycle_manager',\n        executable='lifecycle_manager',\n        name='lifecycle_manager',\n        output='screen',\n        parameters=[{'use_sim_time': LaunchConfiguration('use_sim_time')},\n                    {'autostart': True},\n                    {'node_names': ['map_server',\n                                   'planner_server',\n                                   'controller_server',\n                                   'bt_navigator',\n                                   'amcl',\n                                   'local_costmap',\n                                   'global_costmap']}]\n    )\n\n    # Map server\n    map_server = Node(\n        package='nav2_map_server',\n        executable='map_server',\n        name='map_server',\n        parameters=[{'yaml_filename': os.path.join(pkg_share, 'maps', 'isaac_sim_map.yaml')},\n                    {'frame_id': 'map'},\n                    {'use_sim_time': LaunchConfiguration('use_sim_time')},\n                    {'topic_name': '/map'},\n                    {'broadcast_2tf': True}],\n        output='screen'\n    )\n\n    # Planner server\n    planner_server = Node(\n        package='nav2_planner',\n        executable='planner_server',\n        name='planner_server',\n        parameters=[LaunchConfiguration('params_file'), {'use_sim_time': LaunchConfiguration('use_sim_time')}],\n        output='screen'\n    )\n\n    # Controller server\n    controller_server = Node(\n        package='nav2_controller',\n        executable='controller_server',\n        name='controller_server',\n        parameters=[LaunchConfiguration('params_file'), {'use_sim_time': LaunchConfiguration('use_sim_time')}],\n        output='screen'\n    )\n\n    # Behavior tree navigator\n    bt_navigator = Node(\n        package='nav2_bt_navigator',\n        executable='bt_navigator',\n        name='bt_navigator',\n        parameters=[LaunchConfiguration('params_file'), {'use_sim_time': LaunchConfiguration('use_sim_time')}],\n        output='screen'\n    )\n\n    # Local costmap server\n    local_costmap = Node(\n        package='nav2_costmap_2d',\n        executable='nav2_costmap_2d',\n        name='local_costmap',\n        parameters=[LaunchConfiguration('params_file'), {'use_sim_time': LaunchConfiguration('use_sim_time')}],\n        output='screen'\n    )\n\n    # Global costmap server\n    global_costmap = Node(\n        package='nav2_costmap_2d',\n        executable='nav2_costmap_2d',\n        name='global_costmap',\n        parameters=[LaunchConfiguration('params_file'), {'use_sim_time': LaunchConfiguration('use_sim_time')}],\n        output='screen'\n    )\n\n    # AMCL (for localization)\n    amcl = Node(\n        package='nav2_amcl',\n        executable='amcl',\n        name='amcl',\n        parameters=[LaunchConfiguration('params_file'), {'use_sim_time': LaunchConfiguration('use_sim_time')}],\n        output='screen'\n    )\n\n    # Velocity smoother\n    velocity_smoother = Node(\n        package='nav2_velocity_smoother',\n        executable='velocity_smoother',\n        name='velocity_smoother',\n        parameters=[LaunchConfiguration('params_file'), {'use_sim_time': LaunchConfiguration('use_sim_time')}],\n        output='screen'\n    )\n\n    # Pose publisher\n    pose_publisher = Node(\n        package='nav2_pose_smoother',\n        executable='smoother_node',\n        name='pose_publisher',\n        parameters=[LaunchConfiguration('params_file'), {'use_sim_time': LaunchConfiguration('use_sim_time')}],\n        output='screen'\n    )\n\n    return LaunchDescription([\n        use_sim_time,\n        params_file,\n        lifecycle_manager,\n        map_server,\n        planner_server,\n        controller_server,\n        bt_navigator,\n        local_costmap,\n        global_costmap,\n        amcl,\n        velocity_smoother,\n        pose_publisher\n    ])\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"SLAM Launch File:"}),"\nCreate a launch file for SLAM mapping: ",(0,i.jsx)(e.code,{children:"robotics_ws/src/humanoid_nav2_config/launch/slam_launch.py"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"import os\nfrom launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument\nfrom launch.substitutions import LaunchConfiguration\nfrom launch_ros.actions import Node\nfrom ament_index_python.packages import get_package_share_directory\n\n\ndef generate_launch_description():\n    # Get the package share directory\n    pkg_share = get_package_share_directory('humanoid_nav2_config')\n\n    # Declare launch arguments\n    use_sim_time = DeclareLaunchArgument(\n        'use_sim_time',\n        default_value='true',\n        description='Use simulation (Isaac Sim) clock if true'\n    )\n\n    params_file = DeclareLaunchArgument(\n        'params_file',\n        default_value=os.path.join(pkg_share, 'config', 'slam_params.yaml'),\n        description='Full path to the ROS2 parameters file to use for all launched nodes'\n    )\n\n    # SLAM Toolbox node\n    slam_toolbox = Node(\n        parameters=[\n            LaunchConfiguration('params_file'),\n            {'use_sim_time': LaunchConfiguration('use_sim_time')}\n        ],\n        package='slam_toolbox',\n        executable='async_slam_toolbox_node',\n        name='slam_toolbox',\n        output='screen'\n    )\n\n    return LaunchDescription([\n        use_sim_time,\n        params_file,\n        slam_toolbox\n    ])\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Isaac Sim Navigation Scene:"}),"\nCreate an Isaac Sim scene for navigation testing: ",(0,i.jsx)(e.code,{children:"isaac_sim_assets/isaac_sim_project/scenes/navigation_test.usd"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-usda",children:'#usda 1.0\n(\n    doc = "Navigation test scene for Isaac Sim"\n    metersPerUnit = 1.0\n    upAxis = "Y"\n)\n\ndef Xform "World"\n{\n    def PhysicsScene "physicsScene"\n    {\n        float3 gravity = (0, 0, -981)\n        float timeStepsPerSecond = 60\n        float maxSubSteps = 1\n    }\n\n    def Xform "ground_plane"\n    {\n        def Plane "plane"\n        {\n            add xformOp:scale = (20, 20, 1)\n            add xformOp:translate = (0, 0, 0)\n            prepend apiSchemas = ["PhysicsCollisionAPI"]\n        }\n    }\n\n    # Add some obstacles for navigation challenge\n    def Xform "obstacles"\n    {\n        def Cube "wall_1"\n        {\n            add xformOp:scale = (10, 0.2, 2)\n            add xformOp:translate = (0, 5, 1)\n            prepend apiSchemas = ["PhysicsRigidBodyAPI"]\n        }\n\n        def Cube "wall_2"\n        {\n            add xformOp:scale = (0.2, 10, 2)\n            add xformOp:translate = (5, 0, 1)\n            prepend apiSchemas = ["PhysicsRigidBodyAPI"]\n        }\n\n        def Cube "obstacle_1"\n        {\n            add xformOp:scale = (1, 1, 1)\n            add xformOp:translate = (2, 2, 0.5)\n            prepend apiSchemas = ["PhysicsRigidBodyAPI"]\n        }\n\n        def Cube "obstacle_2"\n        {\n            add xformOp:scale = (1.5, 0.5, 1)\n            add xformOp:translate = (-3, -2, 0.5)\n            prepend apiSchemas = ["PhysicsRigidBodyAPI"]\n        }\n    }\n\n    def Xform "humanoid_robot"\n    {\n        add references = </humanoid_robot/humanoid_with_sensors.usda>\n        add xformOp:translate = (-5, -5, 1.0)\n\n        # Ensure the LiDAR is properly configured for navigation\n        def "RotatingLidar"\n        {\n            add xformOp:translate = (0, 0.5, 0.2)\n            add xformOp:rotateXYZ = (0, 0, 0)\n        }\n    }\n\n    def Xform "distantLight"\n    {\n        add xformOp:rotateXYZ = (0, 45, 0)\n        def DistantLight "distantLight"\n        {\n            float intensity = 300\n            color color = (1, 1, 1)\n        }\n    }\n\n    def Xform "domeLight"\n    {\n        def DomeLight "domeLight"\n        {\n            float intensity = 1\n            color color = (0.2, 0.2, 0.2)\n        }\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Navigation Test Script:"}),"\nCreate a script to send navigation goals: ",(0,i.jsx)(e.code,{children:"robotics_ws/src/humanoid_nav2_config/scripts/send_navigation_goal.py"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'#!/usr/bin/env python3\n\n"""\nNavigation Goal Sender\n\nThis script sends navigation goals to the Nav2 stack for the humanoid robot.\n"""\n\nimport rclpy\nfrom rclpy.node import Node\nfrom rclpy.action import ActionClient\nfrom nav2_msgs.action import NavigateToPose\nfrom geometry_msgs.msg import PoseStamped\nfrom builtin_interfaces.msg import Duration\nimport time\n\n\nclass NavigationGoalSender(Node):\n    def __init__(self):\n        super().__init__(\'navigation_goal_sender\')\n\n        # Create action client for navigation\n        self.nav_to_pose_client = ActionClient(\n            self,\n            NavigateToPose,\n            \'navigate_to_pose\'\n        )\n\n        # Wait for the action server to be available\n        self.nav_to_pose_client.wait_for_server()\n\n        self.get_logger().info("Navigation goal sender initialized")\n\n    def send_goal(self, x, y, theta):\n        """Send a navigation goal to the specified pose"""\n        goal_msg = NavigateToPose.Goal()\n\n        # Set the goal pose\n        goal_msg.pose.header.frame_id = \'map\'\n        goal_msg.pose.header.stamp = self.get_clock().now().to_msg()\n        goal_msg.pose.pose.position.x = x\n        goal_msg.pose.pose.position.y = y\n        goal_msg.pose.pose.position.z = 0.0\n\n        # Convert theta (yaw) to quaternion\n        import math\n        from tf_transformations import quaternion_from_euler\n        quat = quaternion_from_euler(0, 0, theta)\n        goal_msg.pose.pose.orientation.x = quat[0]\n        goal_msg.pose.pose.orientation.y = quat[1]\n        goal_msg.pose.pose.orientation.z = quat[2]\n        goal_msg.pose.pose.orientation.w = quat[3]\n\n        # Send the goal\n        self.get_logger().info(f"Sending navigation goal to ({x}, {y}, {theta})")\n        future = self.nav_to_pose_client.send_goal_async(goal_msg)\n        future.add_done_callback(self.goal_response_callback)\n\n    def goal_response_callback(self, future):\n        """Handle the goal response"""\n        goal_handle = future.result()\n        if not goal_handle.accepted:\n            self.get_logger().info(\'Goal rejected\')\n            return\n\n        self.get_logger().info(\'Goal accepted\')\n        result_future = goal_handle.get_result_async()\n        result_future.add_done_callback(self.get_result_callback)\n\n    def get_result_callback(self, future):\n        """Handle the result of the navigation"""\n        result = future.result().result\n        self.get_logger().info(f\'Navigation result: {result}\')\n        rclpy.shutdown()\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    # Create the navigation goal sender\n    nav_sender = NavigationGoalSender()\n\n    # Send a navigation goal (example: go to x=5, y=5, theta=0)\n    nav_sender.send_goal(5.0, 5.0, 0.0)\n\n    # Spin to process callbacks\n    rclpy.spin(nav_sender)\n\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Testing the Navigation System:"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Launch Isaac Sim with the navigation test scene"}),"\n",(0,i.jsx)(e.li,{children:"Start the SLAM system to create a map:"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"ros2 launch humanoid_nav2_config slam_launch.py\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Drive the robot around to map the environment"}),"\n",(0,i.jsx)(e.li,{children:"Save the map:"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"ros2 run nav2_map_server map_saver_cli -f ~/map\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Launch the navigation system with the saved map:"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"ros2 launch humanoid_nav2_config navigation_launch.py\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Send navigation goals using the test script or RViz2"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"safety-notes",children:"Safety Notes"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Implement proper safety limits for navigation speeds and accelerations"}),"\n",(0,i.jsx)(e.li,{children:"Ensure navigation recovery behaviors are properly configured"}),"\n",(0,i.jsx)(e.li,{children:"Test navigation in simulation before attempting on physical robots"}),"\n",(0,i.jsx)(e.li,{children:"Validate localization accuracy before autonomous navigation"}),"\n",(0,i.jsx)(e.li,{children:"Implement proper obstacle detection and avoidance mechanisms"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"evaluation-criteria",children:"Evaluation Criteria"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Can the humanoid robot create accurate maps of the Isaac Sim environment?"}),"\n",(0,i.jsx)(e.li,{children:"Does the navigation system plan valid paths around obstacles?"}),"\n",(0,i.jsx)(e.li,{children:"Can the robot successfully navigate to specified goal poses?"}),"\n",(0,i.jsx)(e.li,{children:"Are safety mechanisms properly implemented to avoid collisions?"}),"\n",(0,i.jsx)(e.li,{children:"Does the navigation system recover from failures appropriately?"}),"\n",(0,i.jsx)(e.li,{children:"Can the robot maintain stable navigation performance in complex environments?"}),"\n"]})]})}function m(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(c,{...n})}):c(n)}},8453:(n,e,a)=>{a.d(e,{R:()=>t,x:()=>s});var o=a(6540);const i={},r=o.createContext(i);function t(n){const e=o.useContext(r);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:t(n.components),o.createElement(r.Provider,{value:e},n.children)}}}]);